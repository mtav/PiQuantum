<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PiQuantum the raspbery pi powered quantum computer simulator: InputOutput Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PiQuantum the raspbery pi powered quantum computer simulator
   &#160;<span id="projectnumber">Alpha1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">InputOutput Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class for reading buttons and writing to LEDs.  
 <a href="classInputOutput.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="io_8hpp_source.html">io.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for InputOutput:</div>
<div class="dyncontent">
<div class="center"><img src="classInputOutput__inherit__graph.png" border="0" usemap="#InputOutput_inherit__map" alt="Inheritance graph"/></div>
<map name="InputOutput_inherit__map" id="InputOutput_inherit__map">
<area shape="rect" id="node2" href="classAlarm.html" title="Interrupts in Linux. " alt="" coords="23,5,79,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for InputOutput:</div>
<div class="dyncontent">
<div class="center"><img src="classInputOutput__coll__graph.png" border="0" usemap="#InputOutput_coll__map" alt="Collaboration graph"/></div>
<map name="InputOutput_coll__map" id="InputOutput_coll__map">
<area shape="rect" id="node2" href="classAlarm.html" title="Interrupts in Linux. " alt="" coords="23,5,79,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa8647b30b3326062c941fa776ac299ba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classInputOutput.html#aa8647b30b3326062c941fa776ac299ba">InputOutput</a> (std::shared_ptr&lt; <a class="el" href="classSpiChannel.html">SpiChannel</a> &gt; spi)</td></tr>
<tr class="separator:aa8647b30b3326062c941fa776ac299ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a717759dbeeade10e96834aac7e9870f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classInputOutput.html#a717759dbeeade10e96834aac7e9870f3">print</a> ()</td></tr>
<tr class="separator:a717759dbeeade10e96834aac7e9870f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afaedc1471680db1400ca79d8a88a9597"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classInputOutput.html#afaedc1471680db1400ca79d8a88a9597">set_leds</a> (std::vector&lt; <a class="el" href="spi_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> &gt; data)</td></tr>
<tr class="memdesc:afaedc1471680db1400ca79d8a88a9597"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send data to the LEDs.  <a href="#afaedc1471680db1400ca79d8a88a9597">More...</a><br /></td></tr>
<tr class="separator:afaedc1471680db1400ca79d8a88a9597"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afebad847302e61fea4ef1e9e32767222"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="spi_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classInputOutput.html#afebad847302e61fea4ef1e9e32767222">read_button_states</a> (int num)</td></tr>
<tr class="memdesc:afebad847302e61fea4ef1e9e32767222"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read all the button states.  <a href="#afebad847302e61fea4ef1e9e32767222">More...</a><br /></td></tr>
<tr class="separator:afebad847302e61fea4ef1e9e32767222"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c20d30618bfaad6f534159e525e6762"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classInputOutput.html#a0c20d30618bfaad6f534159e525e6762">register_led</a> (<a class="el" href="classLed.html">Led</a> *led)</td></tr>
<tr class="memdesc:a0c20d30618bfaad6f534159e525e6762"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register and deregister LEDs and buttons.  <a href="#a0c20d30618bfaad6f534159e525e6762">More...</a><br /></td></tr>
<tr class="separator:a0c20d30618bfaad6f534159e525e6762"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a272163ec7f49a8ef3a60f796baa4f38b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classInputOutput.html#a272163ec7f49a8ef3a60f796baa4f38b">deregister_led</a> (int id)</td></tr>
<tr class="separator:a272163ec7f49a8ef3a60f796baa4f38b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1ed7c226f5911647edaca6ec338a6c4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classInputOutput.html#ac1ed7c226f5911647edaca6ec338a6c4">register_button</a> (<a class="el" href="classButton.html">Button</a> *btn)</td></tr>
<tr class="separator:ac1ed7c226f5911647edaca6ec338a6c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e41fb0fa6cb1bc79274af806d9befb4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classInputOutput.html#a8e41fb0fa6cb1bc79274af806d9befb4">deregister_button</a> (int id)</td></tr>
<tr class="separator:a8e41fb0fa6cb1bc79274af806d9befb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classAlarm"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classAlarm')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classAlarm.html">Alarm</a></td></tr>
<tr class="memitem:a4850db37bc4518608a41aebcdce71d46 inherit pub_methods_classAlarm"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAlarm.html#a4850db37bc4518608a41aebcdce71d46">Alarm</a> (int delay_us)</td></tr>
<tr class="separator:a4850db37bc4518608a41aebcdce71d46 inherit pub_methods_classAlarm"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class for reading buttons and writing to LEDs. </p>
<p>There are two main parts to the class. The first part is two arrays of pointers (one for button objects and one for LEDs) which are `registered' with this class automatically when they are instantiated.</p>
<p>The second part is a function, called interrupt(), which is called at regular intervals by the SIGALARM signal (a linux thing). This function is responsible for updating the states of the LEDs and reading the state of all the buttons.</p>
<p>The LEDs are controlled using a pulse width modulation type scheme, which interrupt() simulates. I keeps track of a counter, which is incremented by 1 every time interrupt() is called. When it gets to period, it is reset to zero. As the counter ranges through 0 to period, each registered LED object is queried to get an RGB values (between 0 and 1). If this value exceeds counter/period (also between 0 and 1), then the LED is turned off. The LEDs are all switched back on when the counter is reset to zero</p>
<p>The user program never uses this program. It is implicitely instantiated when <a class="el" href="classLed.html" title="RGB Led class. ">Led</a> and <a class="el" href="classButton.html">Button</a> objects are instantiated. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa8647b30b3326062c941fa776ac299ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8647b30b3326062c941fa776ac299ba">&#9670;&nbsp;</a></span>InputOutput()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">InputOutput::InputOutput </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classSpiChannel.html">SpiChannel</a> &gt;&#160;</td>
          <td class="paramname"><em>spi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8e41fb0fa6cb1bc79274af806d9befb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e41fb0fa6cb1bc79274af806d9befb4">&#9670;&nbsp;</a></span>deregister_button()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InputOutput::deregister_button </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a272163ec7f49a8ef3a60f796baa4f38b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a272163ec7f49a8ef3a60f796baa4f38b">&#9670;&nbsp;</a></span>deregister_led()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InputOutput::deregister_led </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a717759dbeeade10e96834aac7e9870f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a717759dbeeade10e96834aac7e9870f3">&#9670;&nbsp;</a></span>print()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InputOutput::print </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afebad847302e61fea4ef1e9e32767222"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afebad847302e61fea4ef1e9e32767222">&#9670;&nbsp;</a></span>read_button_states()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; unsigned char &gt; InputOutput::read_button_states </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read all the button states. </p>
<p>Read a number </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num</td><td>of bytes from the button shift registers and return it in a standard vector. The SIGALARM function (func) calls this function to update the state of all the button objects </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac1ed7c226f5911647edaca6ec338a6c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1ed7c226f5911647edaca6ec338a6c4">&#9670;&nbsp;</a></span>register_button()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int InputOutput::register_button </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classButton.html">Button</a> *&#160;</td>
          <td class="paramname"><em>btn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0c20d30618bfaad6f534159e525e6762"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c20d30618bfaad6f534159e525e6762">&#9670;&nbsp;</a></span>register_led()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int InputOutput::register_led </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLed.html">Led</a> *&#160;</td>
          <td class="paramname"><em>led</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register and deregister LEDs and buttons. </p>
<p>Register a objects with the driver. The function stores a pointer to the object. There's a problem still to solve: how to remove the entry when the <a class="el" href="classLed.html" title="RGB Led class. ">Led</a> object no longer exists. That can be fixed later. </p>

</div>
</div>
<a id="afaedc1471680db1400ca79d8a88a9597"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afaedc1471680db1400ca79d8a88a9597">&#9670;&nbsp;</a></span>set_leds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int InputOutput::set_leds </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="spi_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> &gt;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send data to the LEDs. </p>
<p>Turn on an LED via the external display driver TLC591x.</p>
<p>Send a std::vector of bytes to the LED drivers. This function is called repeatedly in the func SIGALARM function to update the state of the LEDs</p>
<p>On power on, the chip (TLC591x) is in normal mode which means that the clocked bytes sent to the chip set which LEDs are on and which are off (as opposed to setting the current of the LEDs).</p>
<p>This function assumes that a number of the TLC591 chips are connected together. Data is sent via SPI to the first chip and passed along the chain to other devices.</p>
<p>To write to the device:</p>
<p>1) Write a number of bytes to the SPI port, equal to the number of chips connected together 2) Momentarily set the LE(ED1) pin to latch the data onto the output register. 3) Bring the OE(ED2) pin low to enable the current sinking to turn on the LEDs.</p>
<p>See the timing diagram on page 17 of the datasheet for details.</p>
<p>Arguments: a std::vector of the data to write to the display chips </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/oliver/Documents/piquantum/src/final/<a class="el" href="io_8hpp_source.html">io.hpp</a></li>
<li>/home/oliver/Documents/piquantum/src/final/<a class="el" href="io_8cpp.html">io.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
